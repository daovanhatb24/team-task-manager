<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Task Manager - Trello Premium Features</title>
    <script type="text/javascript" nonce="cd45c08a694f4c52a39f51fb98a" src="//local.adguard.org?ts=1754669053192&amp;type=content-script&amp;dmn=bjbgq23dggsj5wd9.canva-hosted-embed.com&amp;url=https%3A%2F%2Fbjbgq23dggsj5wd9.canva-hosted-embed.com%2Fcodelet%2FAAEAEGJqYmdxMjNkZ2dzajV3ZDkAAAAAAZiPmkSlbYvE7YuEJyBLF9vjRX7N-MxhWH8VHLvathjaoEBMbXs%2Findex.html&amp;app=chrome.exe&amp;css=3&amp;js=1&amp;rel=1&amp;rji=1&amp;sbe=1"></script>
<script type="text/javascript" nonce="cd45c08a694f4c52a39f51fb98a" src="//local.adguard.org?ts=1754669053192&amp;name=AutoPager&amp;name=AdGuard%20Extra&amp;name=AdGuard%20Popup%20Blocker&amp;type=user-script"></script><script src="https://cdn.tailwindcss.com"></script>
    <style>
        .task-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .task-card.high-priority {
            border-left-color: #ef4444;
        }
        
        .task-card.medium-priority {
            border-left-color: #f59e0b;
        }
        
        .task-card.low-priority {
            border-left-color: #10b981;
        }
        
        .task-card.completed {
            opacity: 0.7;
            border-left-color: #6b7280;
        }
        
        .timer-display {
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .timer-active {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .productivity-ring {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            position: relative;
            background: conic-gradient(#10b981 0deg, #10b981 var(--progress, 0deg), #e5e7eb var(--progress, 0deg));
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .productivity-ring::before {
            content: '';
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }
        
        .productivity-ring .percentage {
            position: relative;
            z-index: 1;
            font-size: 0.9rem;
            font-weight: bold;
            color: #1f2937;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .chart-bar {
            background: linear-gradient(to top, #3b82f6, #60a5fa);
            border-radius: 4px 4px 0 0;
            margin: 0 1px;
            min-width: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .chart-bar:hover {
            background: linear-gradient(to top, #1d4ed8, #3b82f6);
            transform: scale(1.05);
        }
        
        .time-entry {
            transition: all 0.3s ease;
        }
        
        .time-entry:hover {
            background-color: #f9fafb;
        }
        
        .sidebar-collapsed {
            width: 60px;
        }
        
        .sidebar-expanded {
            width: 280px;
        }
        
        .main-content-expanded {
            margin-left: 280px;
        }
        
        .main-content-collapsed {
            margin-left: 60px;
        }

        /* Calendar Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e5e7eb;
        }
        
        .calendar-day {
            background: white;
            min-height: 120px;
            padding: 8px;
            position: relative;
        }
        
        .calendar-day.other-month {
            background: #f9fafb;
            color: #9ca3af;
        }
        
        .calendar-day.today {
            background: #dbeafe;
        }
        
        .calendar-task {
            background: #3b82f6;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-bottom: 2px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-task:hover {
            background: #1d4ed8;
        }
        
        .calendar-task.high-priority {
            background: #ef4444;
        }
        
        .calendar-task.medium-priority {
            background: #f59e0b;
        }
        
        .calendar-task.low-priority {
            background: #10b981;
        }

        /* Timeline Styles */
        .timeline-container {
            overflow-x: auto;
            background: white;
        }
        
        .timeline-header {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
            background: #f9fafb;
        }
        
        .timeline-task-name {
            width: 200px;
            padding: 12px;
            border-right: 1px solid #e5e7eb;
            font-weight: 500;
            background: white;
            position: sticky;
            left: 0;
            z-index: 10;
        }
        
        .timeline-dates {
            display: flex;
            flex: 1;
        }
        
        .timeline-date {
            width: 40px;
            padding: 8px 4px;
            text-align: center;
            font-size: 0.75rem;
            border-right: 1px solid #e5e7eb;
        }
        
        .timeline-row {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .timeline-bar {
            height: 20px;
            background: #3b82f6;
            border-radius: 10px;
            margin: 6px 0;
            position: relative;
            cursor: pointer;
        }
        
        .timeline-bar.high-priority {
            background: #ef4444;
        }
        
        .timeline-bar.medium-priority {
            background: #f59e0b;
        }
        
        .timeline-bar.low-priority {
            background: #10b981;
        }

        /* Custom Field Styles */
        .custom-field {
            margin-bottom: 12px;
        }
        
        .custom-field label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }
        
        .custom-field input,
        .custom-field select,
        .custom-field textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
        }
        
        .custom-field input:focus,
        .custom-field select:focus,
        .custom-field textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Checklist Styles */
        .checklist-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .checklist-item:last-child {
            border-bottom: none;
        }
        
        .checklist-checkbox {
            margin-right: 12px;
            width: 18px;
            height: 18px;
        }
        
        .checklist-text {
            flex: 1;
            font-size: 0.875rem;
        }
        
        .checklist-text.completed {
            text-decoration: line-through;
            color: #6b7280;
        }
        
        .checklist-progress {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }
        
        .checklist-progress-bar {
            background: #10b981;
            height: 100%;
            transition: width 0.3s ease;
        }

        /* Automation Styles */
        .automation-rule {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .automation-trigger {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .automation-action {
            background: #dcfce7;
            color: #166534;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* View Toggle Styles */
        .view-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 4px;
        }
        
        .view-toggle button {
            flex: 1;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .view-toggle button.active {
            background: white;
            color: #3b82f6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .view-toggle button:not(.active) {
            color: #6b7280;
        }
        
        .view-toggle button:not(.active):hover {
            color: #374151;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Sidebar -->
    <div id="sidebar" class="fixed left-0 top-0 h-full bg-white shadow-lg transition-all duration-300 sidebar-expanded z-40">
        <div class="p-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <div id="sidebarTitle" class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">TM</span>
                    </div>
                    <span class="font-bold text-gray-800">Team Manager Pro</span>
                </div>
                <button onclick="toggleSidebar()" class="p-1 hover:bg-gray-100 rounded">
                    <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <nav class="p-4">
            <div class="space-y-2">
                <button onclick="showSection('dashboard')" id="dashboardBtn" 
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg bg-blue-50 text-blue-700 font-medium">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span id="dashboardText">Dashboard</span>
                </button>
                
                <button onclick="showSection('tasks')" id="tasksBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                    </svg>
                    <span id="tasksText">Tasks</span>
                </button>
                
                <button onclick="showSection('calendar')" id="calendarBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <span id="calendarText">Calendar</span>
                </button>
                
                <button onclick="showSection('timeline')" id="timelineBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
                    </svg>
                    <span id="timelineText">Timeline</span>
                </button>
                
                <button onclick="showSection('timetracking')" id="timetrackingBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span id="timetrackingText">Time Tracking</span>
                </button>
                
                <button onclick="showSection('automation')" id="automationBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <span id="automationText">Automation</span>
                </button>
                
                <button onclick="showSection('team')" id="teamBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    <span id="teamText">Team</span>
                </button>
                
                <button onclick="showSection('templates')" id="templatesBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    <span id="templatesText">Templates</span>
                </button>
                
                <button onclick="showSection('reports')" id="reportsBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span id="reportsText">Reports</span>
                </button>
                
                <button onclick="showSection('powerups')" id="powerupsBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <span id="powerupsText">Power-Ups</span>
                </button>
                
                <button onclick="showSection('collections')" id="collectionsBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    <span id="collectionsText">Collections</span>
                </button>
                
                <button onclick="showSection('advanced')" id="advancedBtn"
                        class="w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                    </svg>
                    <span id="advancedText">Advanced</span>
                </button>
            </div>
        </nav>
        
        <!-- Quick Timer Widget in Sidebar -->
        <div id="sidebarTimer" class="p-4 border-t border-gray-200 mt-auto">
            <div class="bg-gray-50 rounded-lg p-3">
                <div class="text-xs text-gray-600 mb-1">Quick Timer</div>
                <div class="timer-display text-lg" id="sidebarTimerDisplay">00:00:00</div>
                <div class="flex space-x-1 mt-2">
                    <button onclick="quickStartTimer()" id="quickStartBtn" 
                            class="flex-1 bg-green-500 hover:bg-green-600 text-white px-2 py-1 rounded text-xs">
                        ▶️
                    </button>
                    <button onclick="quickStopTimer()" id="quickStopBtn" style="display: none;"
                            class="flex-1 bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">
                        ⏹️
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="transition-all duration-300 main-content-expanded">
        
        <!-- Header -->
        <header class="bg-white shadow-sm border-b border-gray-200 px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 id="pageTitle" class="text-2xl font-bold text-gray-800">Dashboard</h1>
                    <p id="pageSubtitle" class="text-gray-600">Overview of team tasks and productivity</p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-sm text-gray-600">Today's Work</div>
                        <div class="font-semibold text-gray-800" id="headerTodayTime">0h 0m</div>
                    </div>
                    <div class="w-px h-8 bg-gray-300"></div>
                    <button onclick="showNotificationCenter()" class="relative p-2 text-gray-600 hover:text-gray-800">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM11 17H6l5 5v-5z"></path>
                        </svg>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
                    </button>
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-medium text-sm">JD</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="p-6">
            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Total Tasks</p>
                            <p class="text-2xl font-bold text-gray-800" id="totalTasks">0</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Completed</p>
                            <p class="text-2xl font-bold text-green-600" id="completedTasks">0</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Time Today</p>
                            <p class="text-2xl font-bold text-purple-600" id="timeToday">0h 0m</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Team Members</p>
                            <p class="text-2xl font-bold text-orange-600" id="teamMembers">5</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Recent Tasks -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold text-gray-800">Recent Tasks</h2>
                        <button onclick="showSection('tasks')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            View All
                        </button>
                    </div>
                    <div id="recentTasksList" class="space-y-4">
                        <!-- Recent tasks will be populated here -->
                    </div>
                </div>

                <!-- Productivity Overview -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6">Today's Productivity</h2>
                    
                    <div class="text-center mb-6">
                        <div class="productivity-ring mx-auto mb-3" style="--progress: 216deg;">
                            <div class="percentage">60%</div>
                        </div>
                        <p class="text-sm text-gray-600">Goal Achievement</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Focus Time</span>
                            <span class="text-sm font-medium text-gray-800">4h 30m</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Tasks Completed</span>
                            <span class="text-sm font-medium text-gray-800">8/12</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Efficiency</span>
                            <span class="text-sm font-medium text-gray-800">85%</span>
                        </div>
                    </div>
                    
                    <button onclick="showSection('timetracking')" 
                            class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        View Time Tracking
                    </button>
                </div>
            </div>
        </div>

        <!-- Tasks Section -->
        <div id="tasksSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Task Management</h2>
                    <p class="text-gray-600">Manage and track team tasks</p>
                </div>
                <div class="flex space-x-3">
                    <button onclick="showCustomFieldsModal()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        🏷️ Custom Fields
                    </button>
                    <button onclick="showTaskModal()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ➕ Add Task
                    </button>
                </div>
            </div>

            <!-- View Toggle -->
            <div class="mb-6">
                <div class="view-toggle w-fit">
                    <button onclick="setTaskView('grid')" id="gridViewBtn" class="active">
                        📋 Grid View
                    </button>
                    <button onclick="setTaskView('list')" id="listViewBtn">
                        📝 List View
                    </button>
                    <button onclick="setTaskView('board')" id="boardViewBtn">
                        📊 Board View
                    </button>
                </div>
            </div>

            <!-- Task Filters -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                <div class="flex flex-wrap gap-4 items-center">
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-gray-700">Status:</label>
                        <select id="statusFilter" onchange="filterTasks()" 
                                class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">All</option>
                            <option value="todo">To Do</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-gray-700">Priority:</label>
                        <select id="priorityFilter" onchange="filterTasks()" 
                                class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">All</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-gray-700">Assignee:</label>
                        <select id="assigneeFilter" onchange="filterTasks()" 
                                class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">All</option>
                            <option value="john">John Doe</option>
                            <option value="jane">Jane Smith</option>
                            <option value="mike">Mike Johnson</option>
                            <option value="sarah">Sarah Wilson</option>
                        </select>
                    </div>
                    
                    <div class="flex-1">
                        <input type="text" id="searchTasks" placeholder="Search tasks..." 
                               onkeyup="filterTasks()"
                               class="w-full border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Tasks Container -->
            <div id="tasksContainer">
                <!-- Grid View -->
                <div id="tasksGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Tasks will be populated here -->
                </div>
                
                <!-- List View -->
                <div id="tasksList" class="bg-white rounded-xl shadow-sm" style="display: none;">
                    <!-- Tasks list will be populated here -->
                </div>
                
                <!-- Board View -->
                <div id="tasksBoard" class="grid grid-cols-1 md:grid-cols-3 gap-6" style="display: none;">
                    <!-- Board columns will be populated here -->
                </div>
            </div>
        </div>

        <!-- Calendar Section -->
        <div id="calendarSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Calendar View</h2>
                    <p class="text-gray-600">View tasks in calendar format</p>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="previousMonth()" class="p-2 hover:bg-gray-100 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <h3 id="calendarMonth" class="text-xl font-semibold text-gray-800">January 2024</h3>
                    <button onclick="nextMonth()" class="p-2 hover:bg-gray-100 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </button>
                    <button onclick="goToToday()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        Today
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-6">
                <!-- Calendar Header -->
                <div class="calendar-grid mb-1">
                    <div class="text-center font-medium text-gray-700 py-3">Sun</div>
                    <div class="text-center font-medium text-gray-700 py-3">Mon</div>
                    <div class="text-center font-medium text-gray-700 py-3">Tue</div>
                    <div class="text-center font-medium text-gray-700 py-3">Wed</div>
                    <div class="text-center font-medium text-gray-700 py-3">Thu</div>
                    <div class="text-center font-medium text-gray-700 py-3">Fri</div>
                    <div class="text-center font-medium text-gray-700 py-3">Sat</div>
                </div>
                
                <!-- Calendar Body -->
                <div id="calendarGrid" class="calendar-grid">
                    <!-- Calendar days will be populated here -->
                </div>
            </div>
        </div>

        <!-- Timeline Section -->
        <div id="timelineSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Timeline View</h2>
                    <p class="text-gray-600">Gantt chart view of project timeline</p>
                </div>
                <div class="flex items-center space-x-4">
                    <select id="timelineRange" onchange="updateTimeline()" 
                            class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="week">This Week</option>
                        <option value="month" selected>This Month</option>
                        <option value="quarter">This Quarter</option>
                    </select>
                    <button onclick="exportTimeline()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        📊 Export
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="timeline-container">
                    <!-- Timeline Header -->
                    <div class="timeline-header">
                        <div class="timeline-task-name">Task Name</div>
                        <div class="timeline-dates" id="timelineDates">
                            <!-- Timeline dates will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Timeline Body -->
                    <div id="timelineBody">
                        <!-- Timeline rows will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Automation Section -->
        <div id="automationSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Automation (Butler)</h2>
                    <p class="text-gray-600">Automate repetitive tasks and workflows</p>
                </div>
                <button onclick="showAutomationModal()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    ➕ Create Rule
                </button>
            </div>

            <!-- Automation Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Active Rules</p>
                            <p class="text-2xl font-bold text-blue-600" id="activeRules">5</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Actions This Month</p>
                            <p class="text-2xl font-bold text-green-600" id="automationActions">127</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">Time Saved</p>
                            <p class="text-2xl font-bold text-purple-600" id="timeSaved">8.5h</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Automation Rules -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-6">Automation Rules</h3>
                <div id="automationRules" class="space-y-4">
                    <!-- Automation rules will be populated here -->
                </div>
            </div>
        </div>

        <!-- Templates Section -->
        <div id="templatesSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Board Templates</h2>
                    <p class="text-gray-600">Start with pre-built templates for common workflows</p>
                </div>
                <button onclick="showCreateTemplateModal()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    ➕ Create Template
                </button>
            </div>

            <!-- Template Categories -->
            <div class="mb-8">
                <div class="flex space-x-4 border-b border-gray-200">
                    <button onclick="showTemplateCategory('all')" id="allTemplatesBtn" 
                            class="px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600">
                        All Templates
                    </button>
                    <button onclick="showTemplateCategory('project')" id="projectTemplatesBtn" 
                            class="px-4 py-2 font-medium text-gray-600 hover:text-gray-800">
                        Project Management
                    </button>
                    <button onclick="showTemplateCategory('marketing')" id="marketingTemplatesBtn" 
                            class="px-4 py-2 font-medium text-gray-600 hover:text-gray-800">
                        Marketing
                    </button>
                    <button onclick="showTemplateCategory('hr')" id="hrTemplatesBtn" 
                            class="px-4 py-2 font-medium text-gray-600 hover:text-gray-800">
                        HR & Operations
                    </button>
                    <button onclick="showTemplateCategory('personal')" id="personalTemplatesBtn" 
                            class="px-4 py-2 font-medium text-gray-600 hover:text-gray-800">
                        Personal
                    </button>
                </div>
            </div>

            <!-- Templates Grid -->
            <div id="templatesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Templates will be populated here -->
            </div>
        </div>

        <!-- Time Tracking Section -->
        <div id="timetrackingSection" class="p-6" style="display: none;">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Time Tracking & Productivity</h2>
                <p class="text-gray-600">Track your time and boost productivity</p>
            </div>

            <!-- Time Tracking Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-3xl font-bold text-blue-600" id="todayHours">0h 0m</div>
                    <div class="text-sm text-gray-600">Today's Work</div>
                    <div class="text-xs text-gray-400 mt-1">vs yesterday: <span id="todayComparison">+0%</span></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-3xl font-bold text-green-600" id="weekHours">0h 0m</div>
                    <div class="text-sm text-gray-600">This Week</div>
                    <div class="text-xs text-gray-400 mt-1">Goal: <span id="weekGoal">40h</span></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-3xl font-bold text-purple-600" id="avgDaily">0h 0m</div>
                    <div class="text-sm text-gray-600">Daily Average</div>
                    <div class="text-xs text-gray-400 mt-1">Last 7 days</div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-3xl font-bold text-orange-600" id="productivityScore">0%</div>
                    <div class="text-sm text-gray-600">Productivity</div>
                    <div class="text-xs text-gray-400 mt-1" id="productivityTrend">Stable</div>
                </div>
            </div>

            <!-- Time Tracking Content -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Timer Controls -->
                <div class="space-y-6">
                    <!-- Active Timer -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">🎯 Current Session</h3>
                        
                        <div class="timer-display text-center mb-6" id="currentTimer">00:00:00</div>
                        
                        <div class="mb-4">
                            <select id="currentTask" 
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select a task...</option>
                            </select>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button id="startBtn" onclick="startTimer()" 
                                    class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                                ▶️ Start
                            </button>
                            <button id="pauseBtn" onclick="pauseTimer()" style="display: none;"
                                    class="flex-1 bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                                ⏸️ Pause
                            </button>
                            <button id="stopBtn" onclick="stopTimer()" style="display: none;"
                                    class="flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                                ⏹️ Stop
                            </button>
                        </div>
                        
                        <div class="mt-4 text-center">
                            <span class="text-sm text-gray-600">Status: </span>
                            <span id="timerStatus" class="text-sm font-medium text-gray-800">Ready to start</span>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">⚡ Quick Actions</h3>
                        
                        <div class="space-y-3">
                            <button onclick="showTimeEntryModal()" 
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                ➕ Add Manual Entry
                            </button>
                            <button onclick="showGoalsModal()" 
                                    class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                🎯 Set Goals
                            </button>
                            <button onclick="exportTimeData()" 
                                    class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                📊 Export Data
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Analytics & History -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Productivity Chart -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">📈 Weekly Productivity</h3>
                        
                        <div class="h-48 flex items-end justify-between border-b-2 border-gray-200 p-4" id="productivityChart">
                            <!-- Chart bars will be generated here -->
                        </div>
                        
                        <div class="flex justify-between text-xs text-gray-500 mt-2">
                            <span>7 days ago</span>
                            <span>Today</span>
                        </div>
                    </div>

                    <!-- Recent Time Entries -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-800">📝 Recent Time Entries</h3>
                            <button onclick="showAllEntries()" 
                                    class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                View All
                            </button>
                        </div>
                        
                        <div class="space-y-3" id="recentEntries">
                            <!-- Time entries will be populated here -->
                        </div>
                    </div>

                    <!-- Task Time Breakdown -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">⏰ Task Time Breakdown</h3>
                        
                        <div class="space-y-3" id="taskTimeBreakdown">
                            <!-- Task time breakdown will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Team Section -->
        <div id="teamSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Team Management</h2>
                    <p class="text-gray-600">Manage team members and their productivity</p>
                </div>
                <div class="flex space-x-3">
                    <button onclick="showPermissionModal()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ⚡ Phân quyền
                    </button>
                    <button onclick="showAddMemberModal()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        👥 Mời thành viên
                    </button>
                </div>
            </div>

            <!-- Team Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Team Productivity</h3>
                    <div class="text-center">
                        <div class="productivity-ring mx-auto mb-3" style="--progress: 288deg;">
                            <div class="percentage">80%</div>
                        </div>
                        <p class="text-sm text-gray-600">Overall Team Score</p>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Active Members</h3>
                    <div class="text-3xl font-bold text-green-600 text-center">4/5</div>
                    <p class="text-sm text-gray-600 text-center mt-2">Currently working</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Total Hours Today</h3>
                    <div class="text-3xl font-bold text-blue-600 text-center">32h 15m</div>
                    <p class="text-sm text-gray-600 text-center mt-2">Team combined</p>
                </div>
            </div>

            <!-- Team Members List -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-6">Team Members</h3>
                <div id="teamMembersList" class="space-y-4">
                    <!-- Team members will be populated here -->
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reportsSection" class="p-6" style="display: none;">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Reports & Analytics</h2>
                <p class="text-gray-600">Detailed insights and performance reports</p>
            </div>

            <!-- Report Filters -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                <div class="flex flex-wrap gap-4 items-center">
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-gray-700">Period:</label>
                        <select id="reportPeriod" onchange="updateReports()" 
                                class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                            <option value="year">This Year</option>
                        </select>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-gray-700">Team Member:</label>
                        <select id="reportMember" onchange="updateReports()" 
                                class="border border-gray-300 rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">All Members</option>
                            <option value="john">John Doe</option>
                            <option value="jane">Jane Smith</option>
                            <option value="mike">Mike Johnson</option>
                            <option value="sarah">Sarah Wilson</option>
                        </select>
                    </div>
                    
                    <button onclick="exportReport()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        📊 Export Report
                    </button>
                </div>
            </div>

            <!-- Reports Content -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Task Completion Rate</h3>
                    <div class="h-64 flex items-center justify-center text-gray-500">
                        <div class="text-center">
                            <div class="text-4xl mb-2">📊</div>
                            <p>Task completion chart would be here</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Time Distribution</h3>
                    <div class="h-64 flex items-center justify-center text-gray-500">
                        <div class="text-center">
                            <div class="text-4xl mb-2">⏰</div>
                            <p>Time distribution chart would be here</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Productivity Trends</h3>
                    <div class="h-64 flex items-center justify-center text-gray-500">
                        <div class="text-center">
                            <div class="text-4xl mb-2">📈</div>
                            <p>Productivity trends chart would be here</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Team Performance</h3>
                    <div class="h-64 flex items-center justify-center text-gray-500">
                        <div class="text-center">
                            <div class="text-4xl mb-2">👥</div>
                            <p>Team performance chart would be here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Power-Ups Section -->
        <div id="powerupsSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">⚡ Power-Ups & Integrations</h2>
                    <p class="text-gray-600">Extend functionality with powerful integrations</p>
                </div>
                <button onclick="showPowerUpStore()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    🏪 Browse Power-Up Store
                </button>
            </div>

            <!-- Active Power-Ups -->
            <div class="mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">🔌 Active Power-Ups</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="activePowerUps">
                    <!-- Active power-ups will be populated here -->
                </div>
            </div>

            <!-- Available Power-Ups -->
            <div>
                <h3 class="text-lg font-semibold text-gray-800 mb-4">🛍️ Available Power-Ups</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="availablePowerUps">
                    <!-- Available power-ups will be populated here -->
                </div>
            </div>
        </div>

        <!-- Collections Section -->
        <div id="collectionsSection" class="p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">📚 Collections</h2>
                    <p class="text-gray-600">Organize boards into collections for better management</p>
                </div>
                <button onclick="showCreateCollectionModal()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    ➕ Create Collection
                </button>
            </div>

            <!-- Collections Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="collectionsGrid">
                <!-- Collections will be populated here -->
            </div>
        </div>

        <!-- Advanced Features Section -->
        <div id="advancedSection" class="p-6" style="display: none;">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800">🔧 Advanced Features</h2>
                <p class="text-gray-600">Advanced tools for power users</p>
            </div>

            <!-- Feature Categories -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Card Aging -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">⏳ Card Aging</h3>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="cardAgingToggle" class="sr-only peer" onchange="toggleCardAging()">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </label>
                    </div>
                    <p class="text-gray-600 text-sm mb-4">Cards become transparent over time to highlight stale items</p>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-700">Aging starts after:</span>
                            <select id="agingDays" class="border border-gray-300 rounded px-2 py-1 text-sm">
                                <option value="7">7 days</option>
                                <option value="14" selected>14 days</option>
                                <option value="30">30 days</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Advanced Checklists -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">✅ Advanced Checklists</h3>
                    <p class="text-gray-600 text-sm mb-4">Enhanced checklist features with dependencies and templates</p>
                    <div class="space-y-3">
                        <button onclick="showChecklistTemplates()" 
                                class="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            📋 Checklist Templates
                        </button>
                        <button onclick="showChecklistDependencies()" 
                                class="w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            🔗 Item Dependencies
                        </button>
                    </div>
                </div>

                <!-- Bulk Operations -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">⚡ Bulk Operations</h3>
                    <p class="text-gray-600 text-sm mb-4">Perform actions on multiple cards at once</p>
                    <div class="space-y-3">
                        <button onclick="showBulkEdit()" 
                                class="w-full bg-purple-50 hover:bg-purple-100 text-purple-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            ✏️ Bulk Edit Cards
                        </button>
                        <button onclick="showBulkMove()" 
                                class="w-full bg-orange-50 hover:bg-orange-100 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            📦 Bulk Move Cards
                        </button>
                        <button onclick="showBulkArchive()" 
                                class="w-full bg-red-50 hover:bg-red-100 text-red-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            🗄️ Bulk Archive Cards
                        </button>
                    </div>
                </div>

                <!-- Advanced Export -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">📤 Advanced Export</h3>
                    <p class="text-gray-600 text-sm mb-4">Export data in various formats with custom filters</p>
                    <div class="space-y-3">
                        <button onclick="exportToExcel()" 
                                class="w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            📊 Export to Excel
                        </button>
                        <button onclick="exportToCSV()" 
                                class="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            📄 Export to CSV
                        </button>
                        <button onclick="exportToPDF()" 
                                class="w-full bg-red-50 hover:bg-red-100 text-red-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            📑 Export to PDF
                        </button>
                        <button onclick="exportToJSON()" 
                                class="w-full bg-gray-50 hover:bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            🔧 Export to JSON
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Add New Task</h2>
                <button onclick="closeTaskModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="addTask(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Task Title</label>
                    <input type="text" id="taskTitle" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="Enter task title">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="taskDescription" rows="3"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              placeholder="Task description (optional)"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                        <select id="taskPriority" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Assignee</label>
                        <select id="taskAssignee" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="john">John Doe</option>
                            <option value="jane">Jane Smith</option>
                            <option value="mike">Mike Johnson</option>
                            <option value="sarah">Sarah Wilson</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                        <input type="date" id="taskStartDate" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
                        <input type="date" id="taskDueDate" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <!-- Custom Fields -->
                <div id="customFieldsContainer">
                    <!-- Custom fields will be populated here -->
                </div>
                
                <!-- Checklist -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-sm font-medium text-gray-700">Checklist</label>
                        <button type="button" onclick="addChecklistItem()" 
                                class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            + Add Item
                        </button>
                    </div>
                    <div id="checklistContainer" class="space-y-2">
                        <!-- Checklist items will be populated here -->
                    </div>
                </div>
                
                <!-- Dependencies -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Dependencies</label>
                    <select id="taskDependencies" multiple
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <!-- Task options will be populated here -->
                    </select>
                    <p class="text-xs text-gray-500 mt-1">Hold Ctrl/Cmd to select multiple tasks</p>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeTaskModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        Add Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Custom Fields Modal -->
    <div id="customFieldsModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-lg">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">🏷️ Custom Fields</h2>
                <button onclick="closeCustomFieldsModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="mb-6">
                <button onclick="showAddCustomFieldForm()" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-colors">
                    ➕ Add Custom Field
                </button>
            </div>
            
            <div id="addCustomFieldForm" class="mb-6 p-4 bg-gray-50 rounded-lg" style="display: none;">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Field Name</label>
                        <input type="text" id="customFieldName" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="e.g., Story Points, Client">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Field Type</label>
                        <select id="customFieldType" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="text">Text</option>
                            <option value="number">Number</option>
                            <option value="select">Dropdown</option>
                            <option value="date">Date</option>
                            <option value="checkbox">Checkbox</option>
                        </select>
                    </div>
                    <div id="customFieldOptions" style="display: none;">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Options (one per line)</label>
                        <textarea id="customFieldOptionsList" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Option 1&#10;Option 2&#10;Option 3"></textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveCustomField()" 
                                class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            Save Field
                        </button>
                        <button onclick="cancelCustomField()" 
                                class="flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <div>
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Existing Custom Fields</h3>
                <div id="customFieldsList" class="space-y-3">
                    <!-- Custom fields list will be populated here -->
                </div>
            </div>
            
            <div class="flex justify-end pt-6">
                <button onclick="closeCustomFieldsModal()" 
                        class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Automation Modal -->
    <div id="automationModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">🤖 Create Automation Rule</h2>
                <button onclick="closeAutomationModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="saveAutomationRule(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Rule Name</label>
                    <input type="text" id="automationName" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="e.g., Auto-assign high priority tasks">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">When (Trigger)</label>
                    <select id="automationTrigger" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select a trigger...</option>
                        <option value="task_created">A task is created</option>
                        <option value="task_moved">A task is moved to a list</option>
                        <option value="task_completed">A task is completed</option>
                        <option value="due_date_approaching">Due date is approaching</option>
                        <option value="member_assigned">A member is assigned to a task</option>
                        <option value="priority_changed">Priority is changed</option>
                    </select>
                </div>
                
                <div id="triggerConditions" class="space-y-3">
                    <!-- Trigger conditions will be populated based on selection -->
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Then (Action)</label>
                    <select id="automationAction" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select an action...</option>
                        <option value="assign_member">Assign to a member</option>
                        <option value="move_to_list">Move to a list</option>
                        <option value="add_label">Add a label</option>
                        <option value="set_due_date">Set due date</option>
                        <option value="create_checklist">Create checklist</option>
                        <option value="send_notification">Send notification</option>
                    </select>
                </div>
                
                <div id="actionParameters" class="space-y-3">
                    <!-- Action parameters will be populated based on selection -->
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeAutomationModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        Create Rule
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Template Modal -->
    <div id="templateModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-lg">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">📋 Use Template</h2>
                <button onclick="closeTemplateModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div id="templateDetails" class="mb-6">
                <!-- Template details will be populated here -->
            </div>
            
            <form onsubmit="applyTemplate(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Board Name</label>
                    <input type="text" id="templateBoardName" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="Enter board name">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Team</label>
                    <select id="templateTeam" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="current">Current Team</option>
                        <option value="new">Create New Team</option>
                    </select>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeTemplateModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        Create Board
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Time Entry Modal -->
    <div id="timeEntryModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">➕ Add Time Entry</h2>
                <button onclick="closeTimeEntryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="addTimeEntry(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Task</label>
                    <select id="entryTask" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select a task...</option>
                    </select>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Start Time</label>
                        <input type="time" id="entryStartTime" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">End Time</label>
                        <input type="time" id="entryEndTime" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
                    <input type="date" id="entryDate" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeTimeEntryModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        Add Entry
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Goals Modal -->
    <div id="goalsModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-lg">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">🎯 Set Goals</h2>
                <button onclick="closeGoalsModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="saveGoals(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Daily Goal (hours)</label>
                    <input type="number" id="dailyGoal" min="1" max="24" step="0.5" value="8"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Weekly Goal (hours)</label>
                    <input type="number" id="weeklyGoal" min="1" max="168" step="0.5" value="40"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Goal (hours)</label>
                    <input type="number" id="monthlyGoal" min="1" max="744" step="0.5" value="160"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeGoalsModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                        Save Goals
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteConfirmModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-md">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                </div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">Xác nhận xóa</h2>
                <p class="text-gray-600 mb-2">Bạn có chắc chắn muốn xóa:</p>
                <p class="font-medium text-gray-800" id="deleteItemName"></p>
                <p class="text-sm text-red-600 mt-2" id="deleteWarning">Hành động này không thể hoàn tác!</p>
            </div>
            
            <div class="flex justify-center space-x-3">
                <button onclick="closeDeleteConfirmation()" 
                        class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                    Hủy
                </button>
                <button id="confirmDeleteBtn" 
                        class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                    🗑️ Xóa
                </button>
            </div>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="addMemberModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-lg">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">👥 Mời thành viên mới</h2>
                <button onclick="closeAddMemberModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="addTeamMember(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                    <input type="email" id="memberEmail" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="user@example.com">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Họ và tên *</label>
                    <input type="text" id="memberName" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="Nguyễn Văn A">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Quyền truy cập Board</label>
                    <select id="memberPermission" onchange="updatePermissionDetails()"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="observer">👁️ Observer - Chỉ xem</option>
                        <option value="member" selected>👤 Board Member - Xem và chỉnh sửa cards</option>
                        <option value="admin">⚡ Board Admin - Toàn quyền quản lý board</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Vai trò (tùy chọn)</label>
                    <input type="text" id="memberRole" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="VD: Developer, Designer, Manager...">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Lời nhắn (tùy chọn)</label>
                    <textarea id="inviteMessage" rows="3"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                              placeholder="Chào mừng bạn tham gia team của chúng tôi!"></textarea>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-medium text-blue-800 mb-2">📋 Quyền hạn chi tiết:</h4>
                    <div id="permissionDetails" class="text-sm text-blue-700">
                        <div class="space-y-1">
                            <div>• Xem và chỉnh sửa cards</div>
                            <div>• Tạo và di chuyển cards</div>
                            <div>• Comment và gắn nhãn</div>
                            <div>• Theo dõi thời gian làm việc</div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeAddMemberModal()" 
                            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                        Hủy
                    </button>
                    <button type="submit" 
                            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                        📧 Gửi lời mời
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Permission Management Modal -->
    <div id="permissionModal" class="modal">
        <div class="bg-white rounded-lg shadow-2xl p-6 w-full max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">⚡ Quản lý phân quyền</h2>
                <button onclick="closePermissionModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-6">
                <!-- Current User Info -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center">
                            <span class="text-white font-medium">JD</span>
                        </div>
                        <div>
                            <h3 class="font-medium text-gray-800">John Doe (Bạn)</h3>
                            <p class="text-sm text-gray-600">john@example.com</p>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                                👑 Owner
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Team Members List -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Thành viên team</h3>
                    <div id="permissionMembersList" class="space-y-3">
                        <!-- Members will be populated here -->
                    </div>
                </div>
                
                <!-- Permission Levels Info -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-medium text-gray-800 mb-3">📋 Các cấp độ quyền truy cập Board:</h4>
                    <div class="space-y-3 text-sm">
                        <div class="flex items-start space-x-3">
                            <span class="w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-xs mt-0.5">👁️</span>
                            <div>
                                <div class="font-medium">Observer</div>
                                <div class="text-gray-600">• Chỉ xem board và cards</div>
                                <div class="text-gray-600">• Không thể chỉnh sửa hoặc comment</div>
                                <div class="text-gray-600">• Phù hợp cho stakeholders, clients</div>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs mt-0.5">👤</span>
                            <div>
                                <div class="font-medium">Board Member</div>
                                <div class="text-gray-600">• Tạo, chỉnh sửa và di chuyển cards</div>
                                <div class="text-gray-600">• Comment, gắn nhãn và assign members</div>
                                <div class="text-gray-600">• Theo dõi thời gian và cập nhật tiến độ</div>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center text-xs mt-0.5">⚡</span>
                            <div>
                                <div class="font-medium">Board Admin</div>
                                <div class="text-gray-600">• Tất cả quyền của Board Member</div>
                                <div class="text-gray-600">• Mời và xóa thành viên</div>
                                <div class="text-gray-600">• Thay đổi settings và quyền hạn</div>
                                <div class="text-gray-600">• Xóa board (nếu là owner)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end pt-6">
                <button onclick="closePermissionModal()" 
                        class="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors">
                    Đóng
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let tasks = [];
        let timeEntries = [];
        let customFields = [];
        let automationRules = [];
        let templates = [];
        let currentView = 'grid';
        let currentCalendarDate = new Date();
        
        // Navigation Functions - MUST BE FIRST
        function showSection(sectionName) {
            // Hide all sections
            const sections = ['dashboard', 'tasks', 'calendar', 'timeline', 'timetracking', 'automation', 'team', 'templates', 'reports', 'powerups', 'collections', 'advanced'];
            sections.forEach(section => {
                const sectionEl = document.getElementById(section + 'Section');
                const btnEl = document.getElementById(section + 'Btn');
                if (sectionEl) sectionEl.style.display = 'none';
                if (btnEl) btnEl.className = 'w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg text-gray-700 hover:bg-gray-100';
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + 'Section');
            const targetBtn = document.getElementById(sectionName + 'Btn');
            if (targetSection) targetSection.style.display = 'block';
            if (targetBtn) targetBtn.className = 'w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg bg-blue-50 text-blue-700 font-medium';
            
            // Update page title
            const titles = {
                dashboard: { title: 'Dashboard', subtitle: 'Overview of team tasks and productivity' },
                tasks: { title: 'Task Management', subtitle: 'Manage and track team tasks' },
                calendar: { title: 'Calendar View', subtitle: 'View tasks in calendar format' },
                timeline: { title: 'Timeline View', subtitle: 'Gantt chart view of project timeline' },
                timetracking: { title: 'Time Tracking', subtitle: 'Track your time and boost productivity' },
                automation: { title: 'Automation (Butler)', subtitle: 'Automate repetitive tasks and workflows' },
                team: { title: 'Team Management', subtitle: 'Manage team members and their productivity' },
                templates: { title: 'Board Templates', subtitle: 'Start with pre-built templates for common workflows' },
                reports: { title: 'Reports & Analytics', subtitle: 'Detailed insights and performance reports' },
                powerups: { title: 'Power-Ups & Integrations', subtitle: 'Extend functionality with powerful integrations' },
                collections: { title: 'Collections', subtitle: 'Organize boards into collections for better management' },
                advanced: { title: 'Advanced Features', subtitle: 'Advanced tools for power users' }
            };
            
            if (titles[sectionName]) {
                const titleEl = document.getElementById('pageTitle');
                const subtitleEl = document.getElementById('pageSubtitle');
                if (titleEl) titleEl.textContent = titles[sectionName].title;
                if (subtitleEl) subtitleEl.textContent = titles[sectionName].subtitle;
            }
            
            // Initialize section-specific data
            if (sectionName === 'tasks') {
                initializeTasksSection();
            } else if (sectionName === 'calendar') {
                initializeCalendarSection();
            } else if (sectionName === 'timeline') {
                initializeTimelineSection();
            } else if (sectionName === 'timetracking') {
                initializeTimeTrackingSection();
            } else if (sectionName === 'automation') {
                initializeAutomationSection();
            } else if (sectionName === 'team') {
                initializeTeamSection();
            } else if (sectionName === 'templates') {
                initializeTemplatesSection();
            } else if (sectionName === 'reports') {
                initializeReportsSection();
            } else if (sectionName === 'powerups') {
                initializePowerUps();
            } else if (sectionName === 'collections') {
                initializeCollections();
            } else if (sectionName === 'advanced') {
                initializeAdvancedFeatures();
            }
        }
        
        let teamMembers = [
            { id: 'john', name: 'John Doe', email: 'john@example.com', role: 'Product Owner', avatar: 'JD', status: 'active', permission: 'admin', joinedAt: new Date('2024-01-01') },
            { id: 'jane', name: 'Jane Smith', email: 'jane@example.com', role: 'UI/UX Designer', avatar: 'JS', status: 'active', permission: 'member', joinedAt: new Date('2024-01-15') },
            { id: 'mike', name: 'Mike Johnson', email: 'mike@example.com', role: 'Frontend Developer', avatar: 'MJ', status: 'active', permission: 'member', joinedAt: new Date('2024-02-01') },
            { id: 'sarah', name: 'Sarah Wilson', email: 'sarah@example.com', role: 'QA Tester', avatar: 'SW', status: 'inactive', permission: 'observer', joinedAt: new Date('2024-02-15') }
        ];
        
        let currentSession = {
            startTime: null,
            taskId: null,
            duration: 0,
            isActive: false,
            isPaused: false
        };
        
        let goals = {
            daily: 8,
            weekly: 40,
            monthly: 160
        };
        
        let timerInterval = null;
        let quickTimerInterval = null;
        let quickTimerStart = null;
        let sidebarCollapsed = false;

        // Initialize sample data
        function initializeSampleData() {
            // Sample custom fields
            customFields = [
                { id: 1, name: 'Story Points', type: 'number', options: [] },
                { id: 2, name: 'Client', type: 'select', options: ['Client A', 'Client B', 'Client C'] },
                { id: 3, name: 'Sprint', type: 'text', options: [] }
            ];
            
            // Sample automation rules
            automationRules = [
                {
                    id: 1,
                    name: 'Auto-assign high priority tasks',
                    trigger: 'task_created',
                    conditions: { priority: 'high' },
                    action: 'assign_member',
                    parameters: { member: 'john' },
                    active: true,
                    actionsCount: 23
                },
                {
                    id: 2,
                    name: 'Move completed tasks',
                    trigger: 'task_completed',
                    conditions: {},
                    action: 'move_to_list',
                    parameters: { list: 'Done' },
                    active: true,
                    actionsCount: 45
                },
                {
                    id: 3,
                    name: 'Due date reminder',
                    trigger: 'due_date_approaching',
                    conditions: { days: 1 },
                    action: 'send_notification',
                    parameters: { message: 'Task due tomorrow' },
                    active: true,
                    actionsCount: 12
                }
            ];
            
            // Sample templates
            templates = [
                {
                    id: 1,
                    name: 'Kanban Project Board',
                    category: 'project',
                    description: 'A classic Kanban board for project management with To Do, In Progress, and Done columns.',
                    preview: '📋',
                    lists: ['Backlog', 'To Do', 'In Progress', 'Review', 'Done'],
                    sampleTasks: 8
                },
                {
                    id: 2,
                    name: 'Sprint Planning',
                    category: 'project',
                    description: 'Agile sprint planning board with user stories and sprint goals.',
                    preview: '🏃‍♂️',
                    lists: ['Product Backlog', 'Sprint Backlog', 'In Progress', 'Testing', 'Done'],
                    sampleTasks: 12
                },
                {
                    id: 3,
                    name: 'Marketing Campaign',
                    category: 'marketing',
                    description: 'Plan and execute marketing campaigns from ideation to launch.',
                    preview: '📢',
                    lists: ['Ideas', 'Planning', 'Content Creation', 'Review', 'Published'],
                    sampleTasks: 10
                },
                {
                    id: 4,
                    name: 'Content Calendar',
                    category: 'marketing',
                    description: 'Organize your content creation and publishing schedule.',
                    preview: '📅',
                    lists: ['Content Ideas', 'Writing', 'Editing', 'Scheduled', 'Published'],
                    sampleTasks: 15
                },
                {
                    id: 5,
                    name: 'Employee Onboarding',
                    category: 'hr',
                    description: 'Streamline the onboarding process for new team members.',
                    preview: '👋',
                    lists: ['Pre-boarding', 'First Day', 'First Week', 'First Month', 'Completed'],
                    sampleTasks: 20
                },
                {
                    id: 6,
                    name: 'Personal GTD',
                    category: 'personal',
                    description: 'Getting Things Done methodology for personal productivity.',
                    preview: '✅',
                    lists: ['Inbox', 'Next Actions', 'Waiting For', 'Someday/Maybe', 'Done'],
                    sampleTasks: 6
                }
            ];
            
            // Sample tasks with enhanced features
            tasks = [
                {
                    id: 1,
                    title: 'Design new landing page',
                    description: 'Create a modern, responsive landing page for the new product launch',
                    priority: 'high',
                    assignee: 'jane',
                    status: 'in-progress',
                    startDate: '2024-01-15',
                    dueDate: '2024-01-25',
                    createdAt: new Date('2024-01-10'),
                    timeSpent: 14400, // 4 hours
                    customFields: { 'Story Points': 8, 'Client': 'Client A', 'Sprint': 'Sprint 1' },
                    checklist: [
                        { id: 1, text: 'Research competitor designs', completed: true },
                        { id: 2, text: 'Create wireframes', completed: true },
                        { id: 3, text: 'Design mockups', completed: false },
                        { id: 4, text: 'Get stakeholder approval', completed: false }
                    ],
                    dependencies: []
                },
                {
                    id: 2,
                    title: 'Implement user authentication',
                    description: 'Add login/logout functionality with JWT tokens',
                    priority: 'high',
                    assignee: 'mike',
                    status: 'todo',
                    startDate: '2024-01-20',
                    dueDate: '2024-01-30',
                    createdAt: new Date('2024-01-12'),
                    timeSpent: 7200, // 2 hours
                    customFields: { 'Story Points': 13, 'Client': 'Client A', 'Sprint': 'Sprint 1' },
                    checklist: [
                        { id: 1, text: 'Set up JWT library', completed: false },
                        { id: 2, text: 'Create login form', completed: false },
                        { id: 3, text: 'Implement backend auth', completed: false },
                        { id: 4, text: 'Add password reset', completed: false }
                    ],
                    dependencies: [1]
                },
                {
                    id: 3,
                    title: 'Write API documentation',
                    description: 'Document all REST API endpoints with examples',
                    priority: 'medium',
                    assignee: 'mike',
                    status: 'completed',
                    startDate: '2024-01-08',
                    dueDate: '2024-01-18',
                    createdAt: new Date('2024-01-05'),
                    completedAt: new Date('2024-01-17'),
                    timeSpent: 10800, // 3 hours
                    customFields: { 'Story Points': 5, 'Client': 'Client B', 'Sprint': 'Sprint 1' },
                    checklist: [
                        { id: 1, text: 'List all endpoints', completed: true },
                        { id: 2, text: 'Add request examples', completed: true },
                        { id: 3, text: 'Add response examples', completed: true },
                        { id: 4, text: 'Review with team', completed: true }
                    ],
                    dependencies: []
                }
            ];
        }

        // Sidebar Functions
        function toggleSidebar() {
            sidebarCollapsed = !sidebarCollapsed;
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (sidebarCollapsed) {
                sidebar.className = 'fixed left-0 top-0 h-full bg-white shadow-lg transition-all duration-300 sidebar-collapsed z-40';
                mainContent.className = 'transition-all duration-300 main-content-collapsed';
                
                // Hide text elements
                document.getElementById('sidebarTitle').style.display = 'none';
                document.getElementById('dashboardText').style.display = 'none';
                document.getElementById('tasksText').style.display = 'none';
                document.getElementById('calendarText').style.display = 'none';
                document.getElementById('timelineText').style.display = 'none';
                document.getElementById('timetrackingText').style.display = 'none';
                document.getElementById('automationText').style.display = 'none';
                document.getElementById('teamText').style.display = 'none';
                document.getElementById('templatesText').style.display = 'none';
                document.getElementById('reportsText').style.display = 'none';
                document.getElementById('powerupsText').style.display = 'none';
                document.getElementById('collectionsText').style.display = 'none';
                document.getElementById('advancedText').style.display = 'none';
                document.getElementById('sidebarTimer').style.display = 'none';
            } else {
                sidebar.className = 'fixed left-0 top-0 h-full bg-white shadow-lg transition-all duration-300 sidebar-expanded z-40';
                mainContent.className = 'transition-all duration-300 main-content-expanded';
                
                // Show text elements
                document.getElementById('sidebarTitle').style.display = 'flex';
                document.getElementById('dashboardText').style.display = 'inline';
                document.getElementById('tasksText').style.display = 'inline';
                document.getElementById('calendarText').style.display = 'inline';
                document.getElementById('timelineText').style.display = 'inline';
                document.getElementById('timetrackingText').style.display = 'inline';
                document.getElementById('automationText').style.display = 'inline';
                document.getElementById('teamText').style.display = 'inline';
                document.getElementById('templatesText').style.display = 'inline';
                document.getElementById('reportsText').style.display = 'inline';
                document.getElementById('powerupsText').style.display = 'inline';
                document.getElementById('collectionsText').style.display = 'inline';
                document.getElementById('advancedText').style.display = 'inline';
                document.getElementById('sidebarTimer').style.display = 'block';
            }
        }



        // Section Initialization Functions
        function initializeTasksSection() {
            renderTasks();
            populateTaskFilters();
        }

        function initializeCalendarSection() {
            renderCalendar();
            updateCalendarDisplay();
        }

        function initializeTimelineSection() {
            renderTimeline();
            updateTimelineDisplay();
        }

        function initializeTimeTrackingSection() {
            updateTimeTrackingStats();
            generateProductivityChart();
            renderRecentTimeEntries();
            renderTaskTimeBreakdown();
            populateTaskSelect();
        }

        function initializeAutomationSection() {
            renderAutomationRules();
            updateAutomationStats();
        }

        function initializeTeamSection() {
            renderTeamMembers();
            updateTeamStats();
        }

        function initializeTemplatesSection() {
            renderTemplates();
            showTemplateCategory('all');
        }

        function initializeReportsSection() {
            updateReports();
            generateReportCharts();
        }

        // Task View Functions
        function setTaskView(viewType) {
            currentView = viewType;
            
            // Update view toggle buttons
            const buttons = ['gridViewBtn', 'listViewBtn', 'boardViewBtn'];
            buttons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    if (btnId === viewType + 'ViewBtn') {
                        btn.className = 'active';
                    } else {
                        btn.className = '';
                    }
                }
            });
            
            // Show/hide appropriate view containers
            const containers = ['tasksGrid', 'tasksList', 'tasksBoard'];
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    if (containerId === 'tasks' + viewType.charAt(0).toUpperCase() + viewType.slice(1)) {
                        container.style.display = viewType === 'grid' ? 'grid' : 'block';
                    } else {
                        container.style.display = 'none';
                    }
                }
            });
            
            renderTasks();
        }

        function filterTasks() {
            const statusFilter = document.getElementById('statusFilter')?.value || '';
            const priorityFilter = document.getElementById('priorityFilter')?.value || '';
            const assigneeFilter = document.getElementById('assigneeFilter')?.value || '';
            const searchTerm = document.getElementById('searchTasks')?.value.toLowerCase() || '';
            
            let filteredTasks = tasks.filter(task => {
                const matchesStatus = !statusFilter || task.status === statusFilter;
                const matchesPriority = !priorityFilter || task.priority === priorityFilter;
                const matchesAssignee = !assigneeFilter || task.assignee === assigneeFilter;
                const matchesSearch = !searchTerm || 
                    task.title.toLowerCase().includes(searchTerm) || 
                    task.description.toLowerCase().includes(searchTerm);
                
                return matchesStatus && matchesPriority && matchesAssignee && matchesSearch;
            });
            
            renderFilteredTasks(filteredTasks);
        }

        function renderFilteredTasks(filteredTasks) {
            const container = document.getElementById('tasksGrid');
            if (container && currentView === 'grid') {
                container.innerHTML = filteredTasks.map(task => createTaskCard(task)).join('');
            }
        }

        function createTaskCard(task) {
            const assigneeName = teamMembers.find(m => m.id === task.assignee)?.name || 'Unassigned';
            const priorityColor = task.priority === 'high' ? 'red' : task.priority === 'medium' ? 'yellow' : 'green';
            const statusColor = task.status === 'completed' ? 'green' : task.status === 'in-progress' ? 'blue' : 'gray';
            
            return `
                <div class="task-card bg-white rounded-xl shadow-sm p-6 border border-gray-200 hover:shadow-md transition-all ${task.priority}-priority ${task.status === 'completed' ? 'completed' : ''}">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="font-semibold text-gray-800 text-lg">${task.title}</h3>
                        <button onclick="editTask(${task.id})" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <p class="text-gray-600 text-sm mb-4">${task.description || 'No description'}</p>
                    
                    <div class="flex items-center justify-between mb-4">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-${priorityColor}-100 text-${priorityColor}-800">
                            ${task.priority} priority
                        </span>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-${statusColor}-100 text-${statusColor}-800">
                            ${task.status}
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between text-sm text-gray-500">
                        <span>👤 ${assigneeName}</span>
                        ${task.dueDate ? `<span>📅 ${new Date(task.dueDate).toLocaleDateString()}</span>` : ''}
                    </div>
                    
                    ${task.timeSpent > 0 ? `
                        <div class="mt-3 text-sm text-blue-600">
                            ⏱️ ${formatDuration(task.timeSpent)} logged
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function populateTaskFilters() {
            // Populate assignee filter
            const assigneeFilter = document.getElementById('assigneeFilter');
            if (assigneeFilter) {
                assigneeFilter.innerHTML = '<option value="">All</option>' + 
                    teamMembers.map(member => `<option value="${member.id}">${member.name}</option>`).join('');
            }
        }

        // Calendar Functions
        function renderCalendar() {
            updateCalendarDisplay();
        }

        function updateCalendarDisplay() {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'];
            
            const monthEl = document.getElementById('calendarMonth');
            if (monthEl) {
                monthEl.textContent = `${monthNames[currentCalendarDate.getMonth()]} ${currentCalendarDate.getFullYear()}`;
            }
            
            generateCalendarGrid();
        }

        function generateCalendarGrid() {
            const container = document.getElementById('calendarGrid');
            if (!container) return;
            
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            let html = '';
            const today = new Date();
            
            for (let i = 0; i < 42; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                const isToday = currentDate.toDateString() === today.toDateString();
                const isCurrentMonth = currentDate.getMonth() === month;
                const dayTasks = tasks.filter(task => 
                    task.dueDate && new Date(task.dueDate).toDateString() === currentDate.toDateString()
                );
                
                html += `
                    <div class="calendar-day ${!isCurrentMonth ? 'other-month' : ''} ${isToday ? 'today' : ''}">
                        <div class="font-medium text-sm mb-2">${currentDate.getDate()}</div>
                        ${dayTasks.map(task => `
                            <div class="calendar-task ${task.priority}-priority" onclick="viewTask(${task.id})">
                                ${task.title.substring(0, 20)}${task.title.length > 20 ? '...' : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function previousMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            updateCalendarDisplay();
        }

        function nextMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            updateCalendarDisplay();
        }

        function goToToday() {
            currentCalendarDate = new Date();
            updateCalendarDisplay();
        }

        // Timeline Functions
        function renderTimeline() {
            updateTimelineDisplay();
        }

        function updateTimelineDisplay() {
            generateTimelineDates();
            generateTimelineRows();
        }

        function generateTimelineDates() {
            const container = document.getElementById('timelineDates');
            if (!container) return;
            
            const today = new Date();
            let html = '';
            
            for (let i = 0; i < 30; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                html += `<div class="timeline-date">${date.getDate()}</div>`;
            }
            
            container.innerHTML = html;
        }

        function generateTimelineRows() {
            const container = document.getElementById('timelineBody');
            if (!container) return;
            
            const activeTasks = tasks.filter(task => task.status !== 'completed');
            
            container.innerHTML = activeTasks.map(task => {
                const startPos = task.startDate ? Math.max(0, (new Date(task.startDate) - new Date()) / (1000 * 60 * 60 * 24)) : 0;
                const duration = task.dueDate && task.startDate ? 
                    (new Date(task.dueDate) - new Date(task.startDate)) / (1000 * 60 * 60 * 24) : 5;
                
                return `
                    <div class="timeline-row">
                        <div class="timeline-task-name">${task.title}</div>
                        <div class="timeline-dates" style="position: relative;">
                            <div class="timeline-bar ${task.priority}-priority" 
                                 style="left: ${startPos * 40}px; width: ${Math.max(40, duration * 40)}px;"
                                 onclick="viewTask(${task.id})">
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTimeline() {
            updateTimelineDisplay();
        }

        function exportTimeline() {
            showNotification('Timeline exported successfully!', 'success');
        }

        // Additional missing functions
        function editTask(taskId) {
            showNotification(`Editing task ${taskId}...`, 'info');
        }

        function viewTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                showNotification(`Viewing task: ${task.title}`, 'info');
            }
        }

        function updateAutomationStats() {
            const activeEl = document.getElementById('activeRules');
            const actionsEl = document.getElementById('automationActions');
            const savedEl = document.getElementById('timeSaved');
            
            if (activeEl) activeEl.textContent = automationRules.filter(r => r.active).length;
            if (actionsEl) actionsEl.textContent = automationRules.reduce((sum, r) => sum + r.actionsCount, 0);
            if (savedEl) savedEl.textContent = '8.5h';
        }

        function updateTeamStats() {
            const membersEl = document.getElementById('teamMembers');
            if (membersEl) membersEl.textContent = teamMembers.length;
        }

        function updateReports() {
            showNotification('Reports updated', 'info');
        }

        function generateReportCharts() {
            showNotification('Report charts generated', 'info');
        }

        function exportReport() {
            showNotification('Report exported successfully!', 'success');
        }

        function exportTimeData() {
            showNotification('Time data exported successfully!', 'success');
        }

        function showAllEntries() {
            showNotification('Showing all time entries...', 'info');
        }

        function addTimeEntry(event) {
            event.preventDefault();
            showNotification('Time entry added successfully!', 'success');
            closeTimeEntryModal();
        }

        function saveGoals(event) {
            event.preventDefault();
            showNotification('Goals saved successfully!', 'success');
            closeGoalsModal();
        }

        function showNotificationCenter() {
            showNotification('Notification center opened', 'info');
        }

        function showCreateTemplateModal() {
            showNotification('Create template modal would open here', 'info');
        }

        function closeTemplateModal() {
            const modal = document.getElementById('templateModal');
            if (modal) modal.classList.remove('active');
        }

        function applyTemplate(event) {
            event.preventDefault();
            showNotification('Template applied successfully!', 'success');
            closeTemplateModal();
        }

        function closeDeleteConfirmation() {
            const modal = document.getElementById('deleteConfirmModal');
            if (modal) modal.classList.remove('active');
        }

        // Power-Ups Functions
        function initializePowerUps() {
            const activePowerUps = [
                {
                    id: 'calendar',
                    name: 'Calendar',
                    description: 'View due dates in calendar format',
                    icon: '📅',
                    status: 'active',
                    category: 'productivity'
                },
                {
                    id: 'time-tracking',
                    name: 'Time Tracking',
                    description: 'Track time spent on tasks',
                    icon: '⏰',
                    status: 'active',
                    category: 'productivity'
                },
                {
                    id: 'voting',
                    name: 'Voting',
                    description: 'Team voting on cards',
                    icon: '🗳️',
                    status: 'active',
                    category: 'collaboration'
                }
            ];
            
            const availablePowerUps = [
                {
                    id: 'github',
                    name: 'GitHub',
                    description: 'Connect GitHub repositories and pull requests',
                    icon: '🐙',
                    status: 'available',
                    category: 'development',
                    price: 'Free'
                },
                {
                    id: 'slack',
                    name: 'Slack',
                    description: 'Get notifications in Slack channels',
                    icon: '💬',
                    status: 'available',
                    category: 'communication',
                    price: 'Free'
                },
                {
                    id: 'google-drive',
                    name: 'Google Drive',
                    description: 'Attach files from Google Drive',
                    icon: '📁',
                    status: 'available',
                    category: 'storage',
                    price: 'Free'
                },
                {
                    id: 'jira',
                    name: 'Jira',
                    description: 'Sync with Jira issues',
                    icon: '🔗',
                    status: 'available',
                    category: 'development',
                    price: '$5/month'
                },
                {
                    id: 'zapier',
                    name: 'Zapier',
                    description: 'Connect with 3000+ apps',
                    icon: '⚡',
                    status: 'available',
                    category: 'automation',
                    price: '$10/month'
                },
                {
                    id: 'figma',
                    name: 'Figma',
                    description: 'Attach Figma designs to cards',
                    icon: '🎨',
                    status: 'available',
                    category: 'design',
                    price: 'Free'
                }
            ];
            
            renderPowerUps(activePowerUps, 'activePowerUps');
            renderPowerUps(availablePowerUps, 'availablePowerUps');
        }
        
        function renderPowerUps(powerUps, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = powerUps.map(powerUp => `
                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${powerUp.icon}</div>
                            <div>
                                <h4 class="font-semibold text-gray-800">${powerUp.name}</h4>
                                <p class="text-sm text-gray-600">${powerUp.description}</p>
                            </div>
                        </div>
                        ${powerUp.status === 'active' ? 
                            `<button onclick="disablePowerUp('${powerUp.id}')" class="bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1 rounded-lg text-sm font-medium transition-colors">
                                Disable
                            </button>` :
                            `<button onclick="enablePowerUp('${powerUp.id}')" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm font-medium transition-colors">
                                ${powerUp.price || 'Enable'}
                            </button>`
                        }
                    </div>
                    <div class="flex items-center justify-between text-sm">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                            ${powerUp.category}
                        </span>
                        ${powerUp.status === 'active' ? 
                            '<span class="text-green-600 font-medium">✓ Active</span>' :
                            '<span class="text-gray-500">Available</span>'
                        }
                    </div>
                </div>
            `).join('');
        }

        // Collections Functions
        function initializeCollections() {
            const collections = [
                {
                    id: 1,
                    name: 'Product Development',
                    description: 'All boards related to product development and engineering',
                    boards: ['Sprint Planning', 'Bug Tracking', 'Feature Requests'],
                    color: 'blue',
                    icon: '🚀'
                },
                {
                    id: 2,
                    name: 'Marketing Campaigns',
                    description: 'Marketing and promotional campaign boards',
                    boards: ['Q1 Campaign', 'Social Media', 'Content Calendar'],
                    color: 'purple',
                    icon: '📢'
                },
                {
                    id: 3,
                    name: 'HR & Operations',
                    description: 'Human resources and operational boards',
                    boards: ['Hiring Pipeline', 'Employee Onboarding', 'Office Management'],
                    color: 'green',
                    icon: '👥'
                }
            ];
            
            renderCollections(collections);
        }
        
        function renderCollections(collections) {
            const container = document.getElementById('collectionsGrid');
            container.innerHTML = collections.map(collection => `
                <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="text-3xl">${collection.icon}</div>
                            <div>
                                <h4 class="font-semibold text-gray-800">${collection.name}</h4>
                                <p class="text-sm text-gray-600">${collection.description}</p>
                            </div>
                        </div>
                        <button onclick="editCollection(${collection.id})" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="space-y-2 mb-4">
                        <div class="text-sm font-medium text-gray-700">Boards (${collection.boards.length}):</div>
                        <div class="flex flex-wrap gap-2">
                            ${collection.boards.map(board => `
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-${collection.color}-100 text-${collection.color}-800">
                                    ${board}
                                </span>
                            `).join('')}
                        </div>
                    </div>
                    <button onclick="viewCollection(${collection.id})" class="w-full bg-gray-50 hover:bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                        View Collection
                    </button>
                </div>
            `).join('');
        }

        // Advanced Features Functions
        function initializeAdvancedFeatures() {
            // Initialize advanced features if needed
        }
        
        function toggleCardAging() {
            const toggle = document.getElementById('cardAgingToggle');
            if (toggle.checked) {
                showNotification('Card aging enabled! Cards will fade after the specified time.', 'success');
            } else {
                showNotification('Card aging disabled.', 'info');
            }
        }
        
        // Export Functions
        function exportToExcel() {
            showNotification('Exporting to Excel... This feature would generate an Excel file with all task data.', 'info');
        }
        
        function exportToCSV() {
            showNotification('Exporting to CSV... This feature would generate a CSV file with task data.', 'info');
        }
        
        function exportToPDF() {
            showNotification('Exporting to PDF... This feature would generate a PDF report.', 'info');
        }
        
        function exportToJSON() {
            showNotification('Exporting to JSON... This feature would export raw data in JSON format.', 'info');
        }
        
        // Bulk Operations
        function showBulkEdit() {
            showNotification('Bulk Edit: This feature would allow editing multiple cards at once.', 'info');
        }
        
        function showBulkMove() {
            showNotification('Bulk Move: This feature would allow moving multiple cards between lists.', 'info');
        }
        
        function showBulkArchive() {
            showNotification('Bulk Archive: This feature would allow archiving multiple cards at once.', 'info');
        }
        
        // Checklist Functions
        function showChecklistTemplates() {
            showNotification('Checklist Templates: This feature would provide pre-made checklist templates.', 'info');
        }
        
        function showChecklistDependencies() {
            showNotification('Item Dependencies: This feature would allow checklist items to depend on others.', 'info');
        }
        
        // Power-Up Functions
        function enablePowerUp(powerUpId) {
            showNotification(`Enabling ${powerUpId} Power-Up...`, 'success');
            setTimeout(() => {
                initializePowerUps(); // Refresh the display
            }, 1000);
        }
        
        function disablePowerUp(powerUpId) {
            showNotification(`Disabling ${powerUpId} Power-Up...`, 'info');
            setTimeout(() => {
                initializePowerUps(); // Refresh the display
            }, 1000);
        }
        
        function showPowerUpStore() {
            showNotification('Opening Power-Up Store... This would show all available integrations.', 'info');
        }
        
        // Collection Functions
        function showCreateCollectionModal() {
            showNotification('Create Collection: This would open a modal to create a new collection.', 'info');
        }
        
        function editCollection(collectionId) {
            showNotification(`Editing collection ${collectionId}...`, 'info');
        }
        
        function viewCollection(collectionId) {
            showNotification(`Viewing collection ${collectionId}...`, 'info');
        }

        // Notification Function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Missing functions that need to be implemented
        function showTaskModal() {
            document.getElementById('taskModal').classList.add('active');
            populateTaskDependencies();
            populateCustomFields();
        }

        function closeTaskModal() {
            document.getElementById('taskModal').classList.remove('active');
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDescription').value = '';
        }

        function addTask(event) {
            event.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const priority = document.getElementById('taskPriority').value;
            const assignee = document.getElementById('taskAssignee').value;
            const startDate = document.getElementById('taskStartDate').value;
            const dueDate = document.getElementById('taskDueDate').value;
            
            if (!title.trim()) {
                showNotification('Please enter a task title', 'error');
                return;
            }
            
            const newTask = {
                id: Date.now(),
                title: title.trim(),
                description: description.trim(),
                priority: priority,
                assignee: assignee,
                status: 'todo',
                startDate: startDate,
                dueDate: dueDate,
                createdAt: new Date(),
                timeSpent: 0,
                customFields: {},
                checklist: [],
                dependencies: []
            };
            
            tasks.push(newTask);
            renderTasks();
            updateDashboard();
            closeTaskModal();
            showNotification('Task created successfully!', 'success');
        }

        function populateTaskDependencies() {
            const select = document.getElementById('taskDependencies');
            if (select) {
                select.innerHTML = tasks.map(task => 
                    `<option value="${task.id}">${task.title}</option>`
                ).join('');
            }
        }

        function populateCustomFields() {
            const container = document.getElementById('customFieldsContainer');
            if (container) {
                container.innerHTML = customFields.map(field => {
                    let input = '';
                    switch (field.type) {
                        case 'text':
                            input = `<input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">`;
                            break;
                        case 'number':
                            input = `<input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">`;
                            break;
                        case 'select':
                            input = `<select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select...</option>
                                ${field.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                            </select>`;
                            break;
                        case 'date':
                            input = `<input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">`;
                            break;
                        case 'checkbox':
                            input = `<input type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">`;
                            break;
                    }
                    
                    return `
                        <div class="custom-field">
                            <label class="block text-sm font-medium text-gray-700 mb-2">${field.name}</label>
                            ${input}
                        </div>
                    `;
                }).join('');
            }
        }

        function addChecklistItem() {
            const container = document.getElementById('checklistContainer');
            if (container) {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'flex items-center space-x-2';
                itemDiv.innerHTML = `
                    <input type="text" placeholder="Checklist item..." 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button type="button" onclick="this.parentElement.remove()" 
                            class="text-red-600 hover:text-red-800">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                `;
                container.appendChild(itemDiv);
            }
        }

        function renderTasks() {
            // This function would render tasks based on current view
            updateDashboard();
        }

        function updateDashboard() {
            // Update dashboard stats
            document.getElementById('totalTasks').textContent = tasks.length;
            document.getElementById('completedTasks').textContent = tasks.filter(t => t.status === 'completed').length;
            
            // Update recent tasks list
            const recentContainer = document.getElementById('recentTasksList');
            if (recentContainer) {
                const recentTasks = tasks.slice(-5).reverse();
                recentContainer.innerHTML = recentTasks.map(task => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <h4 class="font-medium text-gray-800">${task.title}</h4>
                            <p class="text-sm text-gray-600">${task.description || 'No description'}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                task.priority === 'high' ? 'bg-red-100 text-red-800' :
                                task.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                'bg-green-100 text-green-800'
                            }">${task.priority}</span>
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                task.status === 'completed' ? 'bg-green-100 text-green-800' :
                                task.status === 'in-progress' ? 'bg-blue-100 text-blue-800' :
                                'bg-gray-100 text-gray-800'
                            }">${task.status}</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        function renderCalendar() {
            // Calendar rendering logic would go here
            showNotification('Calendar view initialized', 'info');
        }

        function renderTimeline() {
            // Timeline rendering logic would go here
            showNotification('Timeline view initialized', 'info');
        }

        function updateTimeTrackingStats() {
            // Update time tracking statistics
            document.getElementById('todayHours').textContent = '4h 30m';
            document.getElementById('weekHours').textContent = '28h 15m';
            document.getElementById('avgDaily').textContent = '6h 45m';
            document.getElementById('productivityScore').textContent = '85%';
        }

        function generateProductivityChart() {
            // Generate productivity chart
            const chartContainer = document.getElementById('productivityChart');
            if (chartContainer) {
                const days = 7;
                const bars = [];
                for (let i = 0; i < days; i++) {
                    const height = Math.random() * 100 + 20;
                    bars.push(`<div class="chart-bar" style="height: ${height}px;" title="Day ${i + 1}: ${Math.round(height/10)}h"></div>`);
                }
                chartContainer.innerHTML = bars.join('');
            }
        }

        function renderRecentTimeEntries() {
            // Render recent time entries
            const container = document.getElementById('recentEntries');
            if (container) {
                container.innerHTML = `
                    <div class="time-entry flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <div class="font-medium text-gray-800">Design new landing page</div>
                            <div class="text-sm text-gray-600">2h 30m • Today</div>
                        </div>
                        <div class="text-blue-600 font-medium">Active</div>
                    </div>
                `;
            }
        }

        function renderTaskTimeBreakdown() {
            // Render task time breakdown
            const container = document.getElementById('taskTimeBreakdown');
            if (container) {
                container.innerHTML = `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                            <span class="text-gray-800">Development Tasks</span>
                        </div>
                        <span class="font-medium text-gray-800">12h 45m</span>
                    </div>
                `;
            }
        }

        // Custom Fields Functions
        function showCustomFieldsModal() {
            document.getElementById('customFieldsModal').classList.add('active');
            renderCustomFieldsList();
        }

        function closeCustomFieldsModal() {
            document.getElementById('customFieldsModal').classList.remove('active');
            document.getElementById('addCustomFieldForm').style.display = 'none';
        }

        function showAddCustomFieldForm() {
            document.getElementById('addCustomFieldForm').style.display = 'block';
        }

        function cancelCustomField() {
            document.getElementById('addCustomFieldForm').style.display = 'none';
            document.getElementById('customFieldName').value = '';
            document.getElementById('customFieldType').value = 'text';
            document.getElementById('customFieldOptions').style.display = 'none';
            document.getElementById('customFieldOptionsList').value = '';
        }

        function saveCustomField() {
            const name = document.getElementById('customFieldName').value.trim();
            const type = document.getElementById('customFieldType').value;
            const optionsList = document.getElementById('customFieldOptionsList').value;
            
            if (!name) {
                showNotification('Please enter a field name', 'error');
                return;
            }
            
            let options = [];
            if (type === 'select' && optionsList) {
                options = optionsList.split('\n').map(opt => opt.trim()).filter(opt => opt);
            }
            
            const newField = {
                id: Date.now(),
                name: name,
                type: type,
                options: options
            };
            
            customFields.push(newField);
            renderCustomFieldsList();
            cancelCustomField();
            showNotification(`Custom field "${name}" created successfully!`, 'success');
        }

        function renderCustomFieldsList() {
            const container = document.getElementById('customFieldsList');
            if (container) {
                container.innerHTML = customFields.map(field => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <div class="font-medium text-gray-800">${field.name}</div>
                            <div class="text-sm text-gray-600">Type: ${field.type}${field.options.length > 0 ? ` (${field.options.length} options)` : ''}</div>
                        </div>
                        <button onclick="deleteCustomField(${field.id})" class="text-red-600 hover:text-red-800 text-sm">
                            Delete
                        </button>
                    </div>
                `).join('');
            }
        }

        function deleteCustomField(fieldId) {
            customFields = customFields.filter(field => field.id !== fieldId);
            renderCustomFieldsList();
            showNotification('Custom field deleted', 'info');
        }

        // Automation Functions
        function showAutomationModal() {
            document.getElementById('automationModal').classList.add('active');
        }

        function closeAutomationModal() {
            document.getElementById('automationModal').classList.remove('active');
            document.getElementById('automationName').value = '';
            document.getElementById('automationTrigger').value = '';
            document.getElementById('automationAction').value = '';
        }

        function saveAutomationRule(event) {
            event.preventDefault();
            
            const name = document.getElementById('automationName').value.trim();
            const trigger = document.getElementById('automationTrigger').value;
            const action = document.getElementById('automationAction').value;
            
            if (!name || !trigger || !action) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const newRule = {
                id: Date.now(),
                name: name,
                trigger: trigger,
                conditions: {},
                action: action,
                parameters: {},
                active: true,
                actionsCount: 0
            };
            
            automationRules.push(newRule);
            renderAutomationRules();
            closeAutomationModal();
            showNotification(`Automation rule "${name}" created successfully!`, 'success');
        }

        function renderAutomationRules() {
            const container = document.getElementById('automationRules');
            if (container) {
                container.innerHTML = automationRules.map(rule => `
                    <div class="automation-rule">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="font-medium text-gray-800">${rule.name}</h4>
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-600">${rule.actionsCount} actions</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" ${rule.active ? 'checked' : ''} class="sr-only peer" onchange="toggleAutomationRule(${rule.id})">
                                    <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2 text-sm">
                            <span class="automation-trigger">When ${rule.trigger.replace('_', ' ')}</span>
                            <span class="text-gray-400">→</span>
                            <span class="automation-action">Then ${rule.action.replace('_', ' ')}</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        function toggleAutomationRule(ruleId) {
            const rule = automationRules.find(r => r.id === ruleId);
            if (rule) {
                rule.active = !rule.active;
                showNotification(`Automation rule ${rule.active ? 'enabled' : 'disabled'}`, 'info');
            }
        }

        // Templates Functions
        function renderTemplates() {
            const container = document.getElementById('templatesGrid');
            if (container) {
                container.innerHTML = templates.map(template => `
                    <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 hover:shadow-md transition-shadow">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2">${template.preview}</div>
                            <h4 class="font-semibold text-gray-800">${template.name}</h4>
                            <p class="text-sm text-gray-600 mt-2">${template.description}</p>
                        </div>
                        <div class="space-y-2 mb-4">
                            <div class="text-xs text-gray-500">Lists: ${template.lists.join(', ')}</div>
                            <div class="text-xs text-gray-500">${template.sampleTasks} sample tasks included</div>
                        </div>
                        <button onclick="useTemplate(${template.id})" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            Use Template
                        </button>
                    </div>
                `).join('');
            }
        }

        function useTemplate(templateId) {
            const template = templates.find(t => t.id === templateId);
            if (template) {
                showNotification(`Creating board from "${template.name}" template...`, 'success');
                // Here you would actually create a new board with the template structure
                setTimeout(() => {
                    showNotification(`Board "${template.name}" created successfully!`, 'success');
                }, 1500);
            }
        }

        function showTemplateCategory(category) {
            // Update active tab
            const tabs = ['all', 'project', 'marketing', 'hr', 'personal'];
            tabs.forEach(tab => {
                const btn = document.getElementById(tab + 'TemplatesBtn');
                if (btn) {
                    if (tab === category) {
                        btn.className = 'px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600';
                    } else {
                        btn.className = 'px-4 py-2 font-medium text-gray-600 hover:text-gray-800';
                    }
                }
            });
            
            // Filter templates
            const filteredTemplates = category === 'all' ? templates : templates.filter(t => t.category === category);
            const container = document.getElementById('templatesGrid');
            if (container) {
                container.innerHTML = filteredTemplates.map(template => `
                    <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200 hover:shadow-md transition-shadow">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2">${template.preview}</div>
                            <h4 class="font-semibold text-gray-800">${template.name}</h4>
                            <p class="text-sm text-gray-600 mt-2">${template.description}</p>
                        </div>
                        <div class="space-y-2 mb-4">
                            <div class="text-xs text-gray-500">Lists: ${template.lists.join(', ')}</div>
                            <div class="text-xs text-gray-500">${template.sampleTasks} sample tasks included</div>
                        </div>
                        <button onclick="useTemplate(${template.id})" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            Use Template
                        </button>
                    </div>
                `).join('');
            }
        }

        // Team Management Functions
        function showAddMemberModal() {
            document.getElementById('addMemberModal').classList.add('active');
        }

        function closeAddMemberModal() {
            document.getElementById('addMemberModal').classList.remove('active');
            document.getElementById('memberEmail').value = '';
            document.getElementById('memberName').value = '';
            document.getElementById('memberRole').value = '';
            document.getElementById('inviteMessage').value = '';
        }

        function addTeamMember(event) {
            event.preventDefault();
            
            const email = document.getElementById('memberEmail').value.trim();
            const name = document.getElementById('memberName').value.trim();
            const permission = document.getElementById('memberPermission').value;
            const role = document.getElementById('memberRole').value.trim();
            const message = document.getElementById('inviteMessage').value.trim();
            
            if (!email || !name) {
                showNotification('Please enter email and name', 'error');
                return;
            }
            
            const newMember = {
                id: Date.now().toString(),
                name: name,
                email: email,
                role: role || 'Team Member',
                avatar: name.split(' ').map(n => n[0]).join('').toUpperCase(),
                status: 'pending',
                permission: permission,
                joinedAt: new Date()
            };
            
            teamMembers.push(newMember);
            renderTeamMembers();
            closeAddMemberModal();
            showNotification(`Invitation sent to ${name} (${email})`, 'success');
        }

        function updatePermissionDetails() {
            const permission = document.getElementById('memberPermission').value;
            const detailsContainer = document.getElementById('permissionDetails');
            
            const permissions = {
                observer: [
                    '• Chỉ xem board và cards',
                    '• Không thể chỉnh sửa',
                    '• Không thể comment',
                    '• Phù hợp cho stakeholders'
                ],
                member: [
                    '• Xem và chỉnh sửa cards',
                    '• Tạo và di chuyển cards',
                    '• Comment và gắn nhãn',
                    '• Theo dõi thời gian làm việc'
                ],
                admin: [
                    '• Tất cả quyền của Member',
                    '• Mời và xóa thành viên',
                    '• Thay đổi board settings',
                    '• Quản lý quyền hạn'
                ]
            };
            
            if (detailsContainer && permissions[permission]) {
                detailsContainer.innerHTML = `<div class="space-y-1">${permissions[permission].map(p => `<div>${p}</div>`).join('')}</div>`;
            }
        }

        function showPermissionModal() {
            document.getElementById('permissionModal').classList.add('active');
            renderPermissionMembersList();
        }

        function closePermissionModal() {
            document.getElementById('permissionModal').classList.remove('active');
        }

        function renderPermissionMembersList() {
            const container = document.getElementById('permissionMembersList');
            if (container) {
                container.innerHTML = teamMembers.map(member => `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                                <span class="text-white font-medium text-sm">${member.avatar}</span>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">${member.name}</h4>
                                <p class="text-sm text-gray-600">${member.email}</p>
                                <p class="text-xs text-gray-500">${member.role}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                member.permission === 'admin' ? 'bg-orange-100 text-orange-800' :
                                member.permission === 'member' ? 'bg-blue-100 text-blue-800' :
                                'bg-gray-100 text-gray-800'
                            }">
                                ${member.permission === 'admin' ? '⚡ Admin' : 
                                  member.permission === 'member' ? '👤 Member' : '👁️ Observer'}
                            </span>
                            <select onchange="changePermission('${member.id}', this.value)" 
                                    class="text-sm border border-gray-300 rounded px-2 py-1">
                                <option value="observer" ${member.permission === 'observer' ? 'selected' : ''}>Observer</option>
                                <option value="member" ${member.permission === 'member' ? 'selected' : ''}>Member</option>
                                <option value="admin" ${member.permission === 'admin' ? 'selected' : ''}>Admin</option>
                            </select>
                        </div>
                    </div>
                `).join('');
            }
        }

        function changePermission(memberId, newPermission) {
            const member = teamMembers.find(m => m.id === memberId);
            if (member) {
                member.permission = newPermission;
                showNotification(`Permission updated for ${member.name}`, 'success');
                renderPermissionMembersList();
            }
        }

        function renderTeamMembers() {
            const container = document.getElementById('teamMembersList');
            if (container) {
                container.innerHTML = teamMembers.map(member => `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center">
                                <span class="text-white font-medium">${member.avatar}</span>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800">${member.name}</h4>
                                <p class="text-sm text-gray-600">${member.role}</p>
                                <p class="text-xs text-gray-500">${member.email}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <div class="text-sm font-medium text-gray-800">Today: 6h 30m</div>
                                <div class="text-xs text-gray-500">This week: 32h 15m</div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="w-3 h-3 rounded-full ${member.status === 'active' ? 'bg-green-500' : 'bg-gray-400'}"></span>
                                <span class="text-sm text-gray-600">${member.status === 'active' ? 'Active' : 'Offline'}</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // Time Tracking Functions
        function startTimer() {
            const taskSelect = document.getElementById('currentTask');
            if (!taskSelect.value) {
                showNotification('Please select a task first', 'error');
                return;
            }
            
            currentSession.startTime = new Date();
            currentSession.taskId = taskSelect.value;
            currentSession.isActive = true;
            currentSession.isPaused = false;
            
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('stopBtn').style.display = 'inline-block';
            document.getElementById('timerStatus').textContent = 'Running';
            
            timerInterval = setInterval(updateTimer, 1000);
            showNotification('Timer started!', 'success');
        }

        function pauseTimer() {
            currentSession.isPaused = !currentSession.isPaused;
            
            if (currentSession.isPaused) {
                clearInterval(timerInterval);
                document.getElementById('pauseBtn').textContent = '▶️ Resume';
                document.getElementById('timerStatus').textContent = 'Paused';
                showNotification('Timer paused', 'info');
            } else {
                timerInterval = setInterval(updateTimer, 1000);
                document.getElementById('pauseBtn').textContent = '⏸️ Pause';
                document.getElementById('timerStatus').textContent = 'Running';
                showNotification('Timer resumed', 'success');
            }
        }

        function stopTimer() {
            if (currentSession.isActive) {
                clearInterval(timerInterval);
                
                const endTime = new Date();
                const duration = Math.floor((endTime - currentSession.startTime) / 1000);
                
                // Save time entry
                const timeEntry = {
                    id: Date.now(),
                    taskId: currentSession.taskId,
                    startTime: currentSession.startTime,
                    endTime: endTime,
                    duration: duration,
                    date: new Date().toISOString().split('T')[0]
                };
                
                timeEntries.push(timeEntry);
                
                // Update task time spent
                const task = tasks.find(t => t.id == currentSession.taskId);
                if (task) {
                    task.timeSpent = (task.timeSpent || 0) + duration;
                }
                
                // Reset session
                currentSession = {
                    startTime: null,
                    taskId: null,
                    duration: 0,
                    isActive: false,
                    isPaused: false
                };
                
                // Reset UI
                document.getElementById('startBtn').style.display = 'inline-block';
                document.getElementById('pauseBtn').style.display = 'none';
                document.getElementById('stopBtn').style.display = 'none';
                document.getElementById('pauseBtn').textContent = '⏸️ Pause';
                document.getElementById('timerStatus').textContent = 'Ready to start';
                document.getElementById('currentTimer').textContent = '00:00:00';
                
                updateTimeTrackingStats();
                renderRecentTimeEntries();
                showNotification(`Time logged: ${formatDuration(duration)}`, 'success');
            }
        }

        function updateTimer() {
            if (currentSession.isActive && !currentSession.isPaused) {
                const now = new Date();
                const elapsed = Math.floor((now - currentSession.startTime) / 1000);
                document.getElementById('currentTimer').textContent = formatDuration(elapsed);
            }
        }

        function formatDuration(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // Quick Timer Functions
        function quickStartTimer() {
            quickTimerStart = new Date();
            document.getElementById('quickStartBtn').style.display = 'none';
            document.getElementById('quickStopBtn').style.display = 'inline-block';
            
            quickTimerInterval = setInterval(() => {
                const elapsed = Math.floor((new Date() - quickTimerStart) / 1000);
                document.getElementById('sidebarTimerDisplay').textContent = formatDuration(elapsed);
            }, 1000);
            
            showNotification('Quick timer started!', 'success');
        }

        function quickStopTimer() {
            if (quickTimerInterval) {
                clearInterval(quickTimerInterval);
                const elapsed = Math.floor((new Date() - quickTimerStart) / 1000);
                
                document.getElementById('quickStartBtn').style.display = 'inline-block';
                document.getElementById('quickStopBtn').style.display = 'none';
                document.getElementById('sidebarTimerDisplay').textContent = '00:00:00';
                
                showNotification(`Quick timer stopped: ${formatDuration(elapsed)}`, 'info');
            }
        }

        // Modal Functions
        function showTimeEntryModal() {
            document.getElementById('timeEntryModal').classList.add('active');
            populateTaskSelect();
        }

        function closeTimeEntryModal() {
            document.getElementById('timeEntryModal').classList.remove('active');
        }

        function showGoalsModal() {
            document.getElementById('goalsModal').classList.add('active');
        }

        function closeGoalsModal() {
            document.getElementById('goalsModal').classList.remove('active');
        }

        function populateTaskSelect() {
            const selects = ['currentTask', 'entryTask'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">Select a task...</option>' + 
                        tasks.map(task => `<option value="${task.id}">${task.title}</option>`).join('');
                }
            });
        }

        // Fix renderTasks function to actually render tasks
        function renderTasks() {
            const container = document.getElementById('tasksGrid');
            if (container && currentView === 'grid') {
                container.innerHTML = tasks.map(task => createTaskCard(task)).join('');
            }
            
            const listContainer = document.getElementById('tasksList');
            if (listContainer && currentView === 'list') {
                listContainer.innerHTML = `
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Task</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Priority</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Assignee</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Due Date</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${tasks.map(task => {
                                    const assigneeName = teamMembers.find(m => m.id === task.assignee)?.name || 'Unassigned';
                                    return `
                                        <tr class="hover:bg-gray-50">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="font-medium text-gray-900">${task.title}</div>
                                                <div class="text-sm text-gray-500">${task.description || 'No description'}</div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                                    task.priority === 'high' ? 'bg-red-100 text-red-800' :
                                                    task.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-green-100 text-green-800'
                                                }">${task.priority}</span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${assigneeName}</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                                    task.status === 'completed' ? 'bg-green-100 text-green-800' :
                                                    task.status === 'in-progress' ? 'bg-blue-100 text-blue-800' :
                                                    'bg-gray-100 text-gray-800'
                                                }">${task.status}</span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                                ${task.dueDate ? new Date(task.dueDate).toLocaleDateString() : 'No due date'}
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            const boardContainer = document.getElementById('tasksBoard');
            if (boardContainer && currentView === 'board') {
                const columns = {
                    'todo': { title: 'To Do', tasks: tasks.filter(t => t.status === 'todo') },
                    'in-progress': { title: 'In Progress', tasks: tasks.filter(t => t.status === 'in-progress') },
                    'completed': { title: 'Completed', tasks: tasks.filter(t => t.status === 'completed') }
                };
                
                boardContainer.innerHTML = Object.entries(columns).map(([status, column]) => `
                    <div class="bg-gray-100 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold text-gray-800">${column.title}</h3>
                            <span class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-sm">${column.tasks.length}</span>
                        </div>
                        <div class="space-y-3">
                            ${column.tasks.map(task => `
                                <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow cursor-pointer" onclick="viewTask(${task.id})">
                                    <h4 class="font-medium text-gray-800 mb-2">${task.title}</h4>
                                    <p class="text-sm text-gray-600 mb-3">${task.description || 'No description'}</p>
                                    <div class="flex items-center justify-between">
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                            task.priority === 'high' ? 'bg-red-100 text-red-800' :
                                            task.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                            'bg-green-100 text-green-800'
                                        }">${task.priority}</span>
                                        <span class="text-sm text-gray-500">${teamMembers.find(m => m.id === task.assignee)?.name || 'Unassigned'}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            }
            
            updateDashboard();
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeSampleData();
            updateDashboard();
            renderTasks();
            updateTimeTrackingStats();
            generateProductivityChart();
            renderRecentTimeEntries();
            renderTaskTimeBreakdown();
            populateTaskSelect();
            
            // Set current date for date inputs
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) {
                    input.value = today;
                }
            });
            
            // Initialize custom field type change handler
            const customFieldType = document.getElementById('customFieldType');
            if (customFieldType) {
                customFieldType.addEventListener('change', function() {
                    const optionsDiv = document.getElementById('customFieldOptions');
                    if (this.value === 'select') {
                        optionsDiv.style.display = 'block';
                    } else {
                        optionsDiv.style.display = 'none';
                    }
                });
            }
            
            // Initialize all sections properly
            console.log('App initialized successfully!');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96c04ab2e7bd6e52',t:'MTc1NDY2OTUwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
